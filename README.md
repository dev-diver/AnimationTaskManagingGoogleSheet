# AnimationTaskManagingGoogleSheet
Google Spreadsheet animation task managing template
# License
All rights reserved. Unauthorized copying, distribution, modification, or any other use of this code is strictly prohibited.

# 용어 정리

- 사용 주체
    - [관리자]
    - [작업자]
- 작업 요소
    - [컷] - 영상을 이루는 장면
    - [파트] - [컷] 하나를 만들기 위한 프로세스
    - [작업] - 각 [파트]를 진행하기 위해 [작업자]가 진행하는 것
- 기타
    - [작업 데이터] - 각 [파트 시트]에 한 행에 있는 정보들. [작업자],[시작일], [종료일], [진행 현황] 등이 있음
    - [헤더] - [파트 시트] 와 [ㅇㅇ작업자 시트]에 어떤 정보들이 들어가는지 써있는 필드의 제목 모음
    - [데이터 행] - 실제 데이터가 들어있는 행들

# 기능 요구사항

- [파트 시트]들에서 정보를 읽어 [작업자] 별로 자신의 [컷]과 [파트]를 모아 볼 수 있도록 함.
- 정보는 양방향으로 이동해야 함(연동과 보고)

## [관리 파일]

- <컷 수 변경> 4
    - [컷] 수가 변경 될 수 있음
- <파트 추가> 3
    - [파트]가 추가 될 수 있음
    - 새로 추가된 [파트]에 대한 내용도 각 [작업자 파일]에 반영함
- <작업자 추가> 2
    - [작업자]가 늘어나면 [작업자 시트]가 추가로 생성함
- <작업자 배정> 1
    - [파트 시트] 에 [드롭다운] 을 이용해 작업을 배정함
- <작업 배정> 1
    - [파트 시트]에 배정 된 대로 [작업자 파일]에 해당 [작업 데이터]를 복사함
- <작업 변경> 1
    - <날짜 설정>
        - [작업 데이터] 의 [시작 날짜]와 [종료 날짜]를 설정함. 개발 없이 가능.
    - <작업 현황 변경>
        - [작업 데이터] 의 [자업 현황]을 변경함
- <작업 연동>  1
    - 각 행이 각 [작업자 시트]에 반영함
- <작업 재배정> 5
    - [작업자]가 중간에 변경되면 해당 [작업자]로 내용이 옮겨가야 함 ([컷] 이름으로 식별)
    - <작업 배정>의 효율화 된 기능
- <종합 보기>  10
    - 수식으로 연결할 수 있는 [종합 시트] 자동화로 편의성 올리기

## [작업자 파일]

- [관리 파일]로부터 만들어짐
- <연동> 1
    - 각 [컷] 별 변경된 [작업 데이터]가 각 [작업자 파일]의 시트에 반영돼야 함
- <보고>  2
    - 각 [작업자 파일]에서 내용 변경 후 [보고 버튼]을 누를시 [파트 시트]에 [작업 데이터] 가 반영돼야 함
    - [로그]가 순서대로 쌓여야 함
- 편의 기능 (후순위)  10
    - <로그 백업>
    - <최근 로그 보기>

# 시트 구성 및 프로세스 상세

## [메인 파일]

### [설정 시트]

- [컷]
    - [컷 수 설정 셀]
    - [컷 수 변경 버튼]
        - <컷 수 설정> 을 수행
            - 설정한 [컷] 수 만큼 각 [파트 시트]의 [컷]들이 추가로 생성됨
                - [컷] 이름은 순자 순으로 자동 배정
            - 프로젝트를 시작할 때 가장 먼저 실행하고, [관리자]가 <파트 생성>, <작업자 배정>, <작업 배정>을 뒤이어 실행함
            - 기존 [파트 시트] 들이 있다면
                - 늘어난 [컷] 수 만큼 <작업자 배정>과 <날짜 설정>이 되지 않은 빈 [데이터 행] 을 생성함
                - 줄어든 [컷] 수 만큼 아래 [데이터 행]들을 삭제함
- [파트]
    - [파트별 작업자 목록 설정 범위]
        - [파트 시트] 별로 어떤 [작업자]가 있는지 설정 가능한 셀들
    - [파트 생성 버튼] - (구 드롭다운 버튼)
        - <파트 생성>을 수행
            - [파트별 작업자 목록] 을 읽어 [파트별 드롭다운]을 생성
            - [파트 템플릿 시트]를 읽어 [파트 시트] 들을 생성
            - 관리자는 <작업자 배정>,<작업 연동>을 뒤이어 실행함
- [작업] - [종합시트]로 기능을 옮기는 게 나을지 고려 중
    - [작업 배정 버튼]
        - <작업 배정>을 수행
            - 작업 초기화. 오래걸림. 작업 시작 시 최초 한번만 실행할 것 권장
            - 데이터 동기화에 문제가 생기면 해결할 수 있는 간단하지만 오래걸리는 해결책임
            - 실행 과정
                - [ㅇㅇ 작업자 시트] 존재 여부 체크
                    - 없을시 생성
                    - 있다면 [헤더] 밑의 [데이터 행] 을 전부 삭제
                - 각 [파트 시트]에 지정된 [컷] 별 [작업 데이터]들을 [ㅇㅇ작업자 시트]들에 복사함

### [파트 템플릿 시트]

- <파트 생성> 시 참고하기 위한 템플릿
- 구성 요소
    - [헤더]
    - 빈 [데이터 행] 1행- 형식 지정을 위함
    - [진행현황 범위] -진행 현황 수식이 입력된 범위. 복사 시 수식도 복사됨

### [ㅇㅇ파트 시트]

- 다수. 동적으로 생성
- <작업자 배정>
    - [작업자 드롭다운] 을 통해 각 [컷]을 어떤 [작업자]가 맡을 것인지 정함
- <작업 변경>
    - [데이터 영역] 을 변경하는 것.
        - [관리자]가 변경할 수 있는 데이터들
            - [작업자], [시작일], [종료일], [진행 현황]
            - [최종 픽스]는 제외. 변경할 수 있지만 연동되지 않는 정보
        - 변경 시 [작업 변경 체크박스]가 체크됨
    - [작업 변경 체크박스]
        - <작업 변경> 하려는 행을 선택함
        - [진행 현황 드롭다운]이 변경 됐을 때 자동으로 체크됨
- <작업 연동>
    - [작업 연동 버튼]
        - [작업 변경 체크박스] 에 체크된 [작업 데이터]를 [작업자 시트]에 연동함
        - [작업변경 체크박스] 해제
        - 에러처리 - 해당 [작업자 시트]에 배정된 [작업]이 없다면 에러
            - [작업 배정 버튼]을 누르라는 알림
    
- <작업 재배정>
    - [작업 재배정 버튼]
        - [작업자] 가 변경된 [파트]의 [작업 데이터]를 변경된 [작업자 시트]로 옮김
        - <작업 배정> 도 같은 작업을 할 수 있지만, <작업 배정>은 모든 작업자 파일을 초기화하고 재분배하므로 비효율적임.
        - 한 [파트]의 [작업자]만 변경되거나 추가되는 경우 본 기능을 실행할 것을 권장
        - 실행 과정
            - 각 행의 [최근 작업자] 필드를 읽음 - 변경 전 작업자를 알기 위해 유지하는 필드
                - 비어있다면
                    - 새로 생긴 컷.
                    - [작업자 파일](없다면 생성)에 각 파트에 있는 작업들을 배정함 (신규 배정)
                    - 즉, [최근 작업자] 필드가 모두 빈 경우 각 파트별로 진행되는 <작업 배정>임
                - 채워져있다면
                    - 현재 작업자랑 같은지 확인
                        - 같으면 패스
                        - 다르면  (작업 재배정)
                            - 같은 이름의 [작업자 시트]에서 해당 [작업 데이터]를 삭제
                                - 에러처리 - 해당 [작업자 시트]가 없거나, 해당 작업 작업자 시트에 작업이 없다면 알림.
                            - 현재 배정된 [작업자] 와 같은 이름의 [작업자 시트]에 해당 [작업 데이터]를 삽입(배정)
            - 배정시 [최근 작업자]를 현재 작업자로 갱신. (작업 변경 체크박스 해제)

### [작업자 템플릿 시트]

- [작업자 파일] 을 만들기 위한 템플릿

### [로그 시트]

- [작업자 파일] 에서 보고를 누를 때마다 체크박스로 선택된 열의 정보를 순서대로 쌓아 기록함
- [필터]를 걸 수도 있음
- 편의 기능
    - <로그 백업> - 확인한 로그를 [로그 파일]에 백업하고 현재 로그들을 삭제
    - <최근 로그 보기> - 가장 마지막 [로그]로 뷰를 이동

### [종합 시트]

- 모든 파트의 작업 관리가 모여서 보임

## [ㅇㅇ작업자 파일]

- 다수. 동적으로 생성
- [잠금 데이터 영역] - 잠금이 걸려 있어 작업자는 수정할 수 없음
- [진행상황 드롭다운] - <보고>를 하기 위해 진행 상황 선택.
- [보고 체크 박스] - <보고>를 하려는 행을 체크함
- [보고 버튼] - 한 개. 체크 된 [보고 체크 박스] 가 위치한 행의 [진행 상황]을 <보고>
    - <보고> : [파트 시트]에 [보고 날짜]가 업데이트 되고 [보고 횟수]가 올라감
